# C64 Assembly Sequencer Port (Phaser.js)

A not so pixel-perfect and not so sample-accurate JavaScript port of the C64 BASIC/Assembly musical sequencer originally written by [lftkryo](https://www.youtube.com/@lftkryo).

* **Original Video:** [Making 8-bit Music From Scratch at the Commodore 64 BASIC Prompt](https://www.youtube.com/watch?v=ly5BhGOt2vE)

This project replicates the behavior of the 249-byte assembler program encoded in BASIC, that loads the assembler in RAM and also contains part of the user interface, by [Linus Ã…kesson](https://linusakesson.net/). The program synthesizes a 3-voice song using the C64's SID chip and includes a fully interactive sequencer.

This Javascript program emulates the timing, memory reading logic, and sound synthesis tricks of the original hardware within a modern browser using Phaser 3 and the Web Audio API.

It was almost fully generated by the Gemini 3 Pro AI as a test to see if AI would be smart enough to decipher and simulate such a reasonably complex software/hardware setup. It took about 45 minutes with some moderate human coaching. Some more time was spent later to finetune the user interface and presentation.

## How It Works

### 1. Timing (The Jiffy Clock)

The original assembly code uses the C64's system interrupt clock (50Hz on PAL machines) and bit-shifts it right by 3 places (`LSR`) to create the tempo.

* **Math:** 50Hz / 8 = **6.25 steps per second**.
* **Result:** A step delay of exactly **160ms**.

### 2. The Voices (SID Emulation)

The sequencer utilizes all 3 voices of the SID chip with distinct behaviors hardcoded in the assembly data:

* **Voice 1 (Line 81):**
* **Waveform:** Triangle
* **Role:** Melody
* **Envelope:** Long Attack/Release for a "Legato" feel.
* **Logic:** Reads screen memory offset `+127`.

* **Voice 2 (Line 82):**
* **Waveform:** Pulse (Square)
* **Role:** Accompaniment/Chords
* **Envelope:** Short Release for a "Staccato" feel.
* **Logic:** Reads screen memory offset `+167`.

* **Voice 3 (Line 83) - The "Clever" Hack:**
* **Waveform:** Hybrid Sawtooth / Noise
* **Role:** Bass & Drums
* **The Trick:** When the sequencer reads a Letter (Note On), it plays a low **Sawtooth** wave (Bass). When it reads a Space (Note Off), instead of silencing the voice, it switches the waveform to **Noise** and turns the Gate bit off. The "Release" phase of the envelope then plays a fading burst of white noise, creating a synthesized **Snare Drum**.

### 3. Screen Memory Decoding

Pitch is calculated by reading the ASCII character code from the screen and adding a specific 8-bit mask value (`ADC` instruction):

* **Melody:** Character + 82
* **Chords:** Character + 70
* **Bass:** Character + 46

## Controls

The application features a fully interactive 40-column editor.

* **CLICK SCREEN:** Start / Stop the sequencer.
* **ARROW KEYS:** Move the cursor.
* **A - Z:** Write notes (Letters determine pitch).
* **SPACE:** Delete note (Creates silence on V1/V2, Snare hit on V3).
